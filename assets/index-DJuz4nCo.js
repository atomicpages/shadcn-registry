import{r as i,R as _}from"./index-CE0XXScK.js";import{c as h}from"./index-Cvb_kt8_.js";import{d as U,P as R}from"./index-CtBI7pHQ.js";import{u as w}from"./index-Dv1nZR32.js";import{u as b,a as j}from"./index-BErBjXyl.js";import{j as x}from"./jsx-runtime-BjG_zV1W.js";function z(t,e=globalThis==null?void 0:globalThis.document){const s=b(t);i.useEffect(()=>{const n=r=>{r.key==="Escape"&&s(r)};return e.addEventListener("keydown",n,{capture:!0}),()=>e.removeEventListener("keydown",n,{capture:!0})},[s,e])}var H="DismissableLayer",p="dismissableLayer.update",M="dismissableLayer.pointerDownOutside",K="dismissableLayer.focusOutside",O,T=i.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),X=i.forwardRef((t,e)=>{const{disableOutsidePointerEvents:s=!1,onEscapeKeyDown:n,onPointerDownOutside:r,onFocusOutside:a,onInteractOutside:l,onDismiss:d,...E}=t,u=i.useContext(T),[c,B]=i.useState(null),f=(c==null?void 0:c.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,F]=i.useState({}),I=w(e,o=>B(o)),m=Array.from(u.layers),[W]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),k=m.indexOf(W),P=c?m.indexOf(c):-1,A=u.layersWithOutsidePointerEventsDisabled.size>0,D=P>=k,N=q(o=>{const v=o.target,C=[...u.branches].some(y=>y.contains(v));!D||C||(r==null||r(o),l==null||l(o),o.defaultPrevented||d==null||d())},f),L=G(o=>{const v=o.target;[...u.branches].some(y=>y.contains(v))||(a==null||a(o),l==null||l(o),o.defaultPrevented||d==null||d())},f);return z(o=>{P===u.layers.size-1&&(n==null||n(o),!o.defaultPrevented&&d&&(o.preventDefault(),d()))},f),i.useEffect(()=>{if(c)return s&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(O=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(c)),u.layers.add(c),g(),()=>{s&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=O)}},[c,f,s,u]),i.useEffect(()=>()=>{c&&(u.layers.delete(c),u.layersWithOutsidePointerEventsDisabled.delete(c),g())},[c,u]),i.useEffect(()=>{const o=()=>F({});return document.addEventListener(p,o),()=>document.removeEventListener(p,o)},[]),x.jsx(R.div,{...E,ref:I,style:{pointerEvents:A?D?"auto":"none":void 0,...t.style},onFocusCapture:h(t.onFocusCapture,L.onFocusCapture),onBlurCapture:h(t.onBlurCapture,L.onBlurCapture),onPointerDownCapture:h(t.onPointerDownCapture,N.onPointerDownCapture)})});X.displayName=H;var Y="DismissableLayerBranch",$=i.forwardRef((t,e)=>{const s=i.useContext(T),n=i.useRef(null),r=w(e,n);return i.useEffect(()=>{const a=n.current;if(a)return s.branches.add(a),()=>{s.branches.delete(a)}},[s.branches]),x.jsx(R.div,{...t,ref:r})});$.displayName=Y;function q(t,e=globalThis==null?void 0:globalThis.document){const s=b(t),n=i.useRef(!1),r=i.useRef(()=>{});return i.useEffect(()=>{const a=d=>{if(d.target&&!n.current){let E=function(){S(M,s,u,{discrete:!0})};const u={originalEvent:d};d.pointerType==="touch"?(e.removeEventListener("click",r.current),r.current=E,e.addEventListener("click",r.current,{once:!0})):E()}else e.removeEventListener("click",r.current);n.current=!1},l=window.setTimeout(()=>{e.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(l),e.removeEventListener("pointerdown",a),e.removeEventListener("click",r.current)}},[e,s]),{onPointerDownCapture:()=>n.current=!0}}function G(t,e=globalThis==null?void 0:globalThis.document){const s=b(t),n=i.useRef(!1);return i.useEffect(()=>{const r=a=>{a.target&&!n.current&&S(K,s,{originalEvent:a},{discrete:!1})};return e.addEventListener("focusin",r),()=>e.removeEventListener("focusin",r)},[e,s]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function g(){const t=new CustomEvent(p);document.dispatchEvent(t)}function S(t,e,s,{discrete:n}){const r=s.originalEvent.target,a=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:s});e&&r.addEventListener(t,e,{once:!0}),n?U(r,a):r.dispatchEvent(a)}var J=_.useId||(()=>{}),Q=0;function re(t){const[e,s]=i.useState(J());return j(()=>{t||s(n=>n??String(Q++))},[t]),t||(e?`radix-${e}`:"")}export{X as D,re as u};
